{
"version":3,
"file":"out/js/vrpanoview.min.js",
"lineCount":37,
"mappings":"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",
"sources":[" [synthetic:util/defineproperty] "," [synthetic:util/global] "," [synthetic:es6/symbol] "," [synthetic:es6/util/makeiterator] ","src/js/mat4_util.js","src/js/pano_image.js","src/js/pano_info.js","src/js/pano_view.js"],
"sourcesContent":["/*\n * Copyright 2016 The Closure Compiler Authors.\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *     http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\n\n/**\n * @fileoverview Provides methods to polyfill native objects.\n * @suppress {reportUnknownTypes}\n */\n'require util/defines';\n\n\n/**\n * Polyfill for Object.defineProperty() method:\n * https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Global_Objects/Object/defineProperty\n *\n * Refuses to define properties on Array.prototype and Object.prototype,\n * since we can't make them non-enumerable and this messes up peoples' for\n * loops.  Beyond this, we simply assign values and not worry\n * about enumerability or writeability.\n * @param {?} target\n * @param {string} property\n * @param {?} descriptor\n * @suppress {reportUnknownTypes}\n */\n$jscomp.defineProperty =\n    $jscomp.ASSUME_ES5 || typeof Object.defineProperties == 'function' ?\n    Object.defineProperty :\n    function(target, property, descriptor) {\n      descriptor = /** @type {!ObjectPropertyDescriptor} */ (descriptor);\n      // NOTE: This is currently never called with a descriptor outside\n      // the control of the compiler.  If we ever decide to polyfill either\n      // Object.defineProperty or Reflect.defineProperty for ES3, we should\n      // explicitly check for `get` or `set` on the descriptor and throw a\n      // TypeError, since it's impossible to properly polyfill it.\n      if (target == Array.prototype || target == Object.prototype) return;\n      target[property] = descriptor.value;\n    };\n","/*\n * Copyright 2016 The Closure Compiler Authors.\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *     http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\n\n/**\n * @fileoverview Runtime code to store the global object.\n */\n'require base';\n'declare global';\n'declare window';\n\n\n/**\n * @param {!Object} maybeGlobal\n * @return {!Object} The global object.\n * @suppress {undefinedVars|reportUnknownTypes}\n */\n$jscomp.getGlobal = function(maybeGlobal) {\n  return (typeof window != 'undefined' && window === maybeGlobal) ?\n      maybeGlobal :\n      (typeof global != 'undefined' && global != null) ? global : maybeGlobal;\n};\n\n\n// TODO(sdh): This should be typed as \"the global object\", but there's not\n// currently any way to do this in the existing type system.\n/**\n * The global object. For browsers we could just use `this` but in Node that\n * doesn't work.\n * @const {?}\n */\n$jscomp.global = $jscomp.getGlobal(this);\n","/*\n * Copyright 2016 The Closure Compiler Authors.\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *     http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\n\n'require util/defineproperty';\n'require util/global';\n\n/** @const {string} */\n$jscomp.SYMBOL_PREFIX = 'jscomp_symbol_';\n\n\n/**\n * Initializes the Symbol function.\n * @suppress {reportUnknownTypes}\n */\n$jscomp.initSymbol = function() {\n  // Only need to do this once. All future calls are no-ops.\n  $jscomp.initSymbol = function() {};\n\n  if (!$jscomp.global['Symbol']) {\n    $jscomp.global['Symbol'] = $jscomp.Symbol;\n  }\n};\n\n\n/**\n * Produces \"symbols\" (actually just unique strings).\n * @param {string=} opt_description\n * @return {symbol}\n */\n$jscomp.Symbol = /** @type {function(): !Function} */ (function() {\n  var counter = 0;\n  /**\n   * @param {string=} opt_description\n   * @return {symbol}\n   * @suppress {reportUnknownTypes}\n   */\n  function Symbol(opt_description) {\n    return /** @type {?} */ (\n        $jscomp.SYMBOL_PREFIX + (opt_description || '') + (counter++));\n  }\n  return Symbol;\n})();\n\n\n/**\n * Initializes Symbol.iterator (if it's not already defined) and adds a\n * Symbol.iterator property to the Array prototype.\n * @suppress {reportUnknownTypes}\n */\n$jscomp.initSymbolIterator = function() {\n  $jscomp.initSymbol();\n  var symbolIterator = $jscomp.global['Symbol'].iterator;\n  if (!symbolIterator) {\n    symbolIterator = $jscomp.global['Symbol'].iterator =\n        $jscomp.global['Symbol']('iterator');\n  }\n\n  if (typeof Array.prototype[symbolIterator] != 'function') {\n    $jscomp.defineProperty(\n        Array.prototype, symbolIterator, {\n          configurable: true,\n          writable: true,\n          /**\n           * @this {Array}\n           * @return {!IteratorIterable}\n           */\n          value: function() {\n            return $jscomp.arrayIterator(this);\n          }\n        });\n  }\n\n  // Only need to do this once. All future calls are no-ops.\n  $jscomp.initSymbolIterator = function() {};\n};\n\n\n/**\n * Initializes Symbol.asyncIterator (if it's not already defined)\n * @suppress {reportUnknownTypes}\n */\n$jscomp.initSymbolAsyncIterator = function() {\n  $jscomp.initSymbol();\n  var symbolAsyncIterator = $jscomp.global['Symbol'].asyncIterator;\n  if (!symbolAsyncIterator) {\n    symbolAsyncIterator = $jscomp.global['Symbol'].asyncIterator =\n        $jscomp.global['Symbol']('asyncIterator');\n  }\n\n  // Only need to do this once. All future calls are no-ops.\n  $jscomp.initSymbolAsyncIterator = function() {};\n};\n\n\n/**\n * Returns an iterator from the given array.\n * @param {!Array<T>} array\n * @return {!IteratorIterable<T>}\n * @template T\n */\n$jscomp.arrayIterator = function(array) {\n  var index = 0;\n  return $jscomp.iteratorPrototype(function() {\n    if (index < array.length) {\n      return {\n        done: false,\n        value: array[index++],\n      };\n    } else {\n      return {done: true};\n    }\n  });\n};\n\n\n/**\n * Returns an iterator with the given `next` method.  Passing\n * all iterators through this function allows easily extending\n * the definition of `%IteratorPrototype%` if methods are ever\n * added to it in the future.\n *\n * @param {function(this: Iterator<T>): T} next\n * @return {!IteratorIterable<T>}\n * @template T\n * @suppress {reportUnknownTypes}\n */\n$jscomp.iteratorPrototype = function(next) {\n  $jscomp.initSymbolIterator();\n\n  var iterator = {next: next};\n  /**\n   * @this {IteratorIterable}\n   * @return {!IteratorIterable}\n   */\n  iterator[$jscomp.global['Symbol'].iterator] = function() { return this; };\n  return /** @type {!IteratorIterable} */ (iterator);\n};\n","/*\n * Copyright 2016 The Closure Compiler Authors.\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *     http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\n\n/**\n * @fileoverview Polyfill for for-of loops.\n */\n'require es6/symbol';\n\n\n/**\n * Creates an iterator for the given iterable.\n *\n * @param {string|!Iterable<T>|!Iterator<T>|!Arguments<T>} iterable\n * @return {!Iterator<T>}\n * @template T\n * @suppress {reportUnknownTypes}\n */\n$jscomp.makeIterator = function(iterable) {\n  $jscomp.initSymbolIterator();\n\n  // NOTE: Disabling typechecking because [] not allowed on @struct.\n  var iteratorFunction = /** @type {?} */ (iterable)[Symbol.iterator];\n  return iteratorFunction ? iteratorFunction.call(iterable) :\n      $jscomp.arrayIterator(/** @type {!Array} */ (iterable));\n};\n","/**\n * @constructor\n */\nconst Mat4Util = function() {};\n\n/** @const {number} */\nMat4Util.DEG_TO_RAD = Math.PI / 180;\n\n/**\n * @param {number} yaw\n * @return {!Float32Array}\n */\nMat4Util.Yaw = function(yaw) {\n  const s = Math.sin(yaw);\n  const c = Math.cos(yaw);\n  return new Float32Array([c, 0, -s, 0, 0, 1, 0, 0, s, 0, c, 0, 0, 0, 0, 1]);\n}\n\n/**\n * @param {number} pitch\n * @return {!Float32Array}\n */\nMat4Util.Pitch = function(pitch) {\n  const s = Math.sin(pitch);\n  const c = Math.cos(pitch);\n  return new Float32Array([1, 0, 0, 0, 0, c, s, 0, 0, -s, c, 0, 0, 0, 0, 1]);\n}\n\n/**\n * @param {number} roll\n * @return {!Float32Array}\n */\nMat4Util.Roll = function(roll) {\n  const s = Math.sin(roll);\n  const c = Math.cos(roll);\n  return new Float32Array([c, s, 0, 0, -s, c, 0, 0, 0, 0, 1, 0, 0, 0, 0, 1]);\n}\n\n/**\n * @param {!Float32Array} a\n * @param {!Float32Array} b\n * @return {!Float32Array}\n */\nMat4Util.Mul = function(a, b) {\n  const out = new Float32Array(16);\n  const a00 = a[0], a10 = a[4], a20 = a[8], a30 = a[12];\n  const a01 = a[1], a11 = a[5], a21 = a[9], a31 = a[13];\n  const a02 = a[2], a12 = a[6], a22 = a[10], a32 = a[14];\n  const a03 = a[3], a13 = a[7], a23 = a[11], a33 = a[15];\n\n  const b00 = b[0], b10 = b[4], b20 = b[8], b30 = b[12];\n  const b01 = b[1], b11 = b[5], b21 = b[9], b31 = b[13];\n  const b02 = b[2], b12 = b[6], b22 = b[10], b32 = b[14];\n  const b03 = b[3], b13 = b[7], b23 = b[11], b33 = b[15];\n\n  out[0] = a00 * b00 + a10 * b01 + a20 * b02 + a30 * b03;\n  out[1] = a01 * b00 + a11 * b01 + a21 * b02 + a31 * b03;\n  out[2] = a02 * b00 + a12 * b01 + a22 * b02 + a32 * b03;\n  out[3] = a03 * b00 + a13 * b01 + a23 * b02 + a33 * b03;\n\n  out[4] = a00 * b10 + a10 * b11 + a20 * b12 + a30 * b13;\n  out[5] = a01 * b10 + a11 * b11 + a21 * b12 + a31 * b13;\n  out[6] = a02 * b10 + a12 * b11 + a22 * b12 + a32 * b13;\n  out[7] = a03 * b10 + a13 * b11 + a23 * b12 + a33 * b13;\n\n  out[8]  = a00 * b20 + a10 * b21 + a20 * b22 + a30 * b23;\n  out[9]  = a01 * b20 + a11 * b21 + a21 * b22 + a31 * b23;\n  out[10] = a02 * b20 + a12 * b21 + a22 * b22 + a32 * b23;\n  out[11] = a03 * b20 + a13 * b21 + a23 * b22 + a33 * b23;\n\n  out[12] = a00 * b30 + a10 * b31 + a20 * b32 + a30 * b33;\n  out[13] = a01 * b30 + a11 * b31 + a21 * b32 + a31 * b33;\n  out[14] = a02 * b30 + a12 * b31 + a22 * b32 + a32 * b33;\n  out[15] = a03 * b30 + a13 * b31 + a23 * b32 + a33 * b33;\n  return out;\n}\n\n/**\n * @param {!Float32Array} a\n * @return {!Float32Array}\n */\nMat4Util.Inv = function(a) {\n  const out = new Float32Array(16);\n  const a00 = a[0], a10 = a[4], a20 = a[8], a30 = a[12];\n  const a01 = a[1], a11 = a[5], a21 = a[9], a31 = a[13];\n  const a02 = a[2], a12 = a[6], a22 = a[10], a32 = a[14];\n  const a03 = a[3], a13 = a[7], a23 = a[11], a33 = a[15];\n  \n  const s0 = a00 * a11 - a10 * a01;\n  const s1 = a00 * a12 - a10 * a02;\n  const s2 = a00 * a13 - a10 * a03;\n  const s3 = a01 * a12 - a11 * a02;\n  const s4 = a01 * a13 - a11 * a03;\n  const s5 = a02 * a13 - a12 * a03;\n\n  const c5 = a22 * a33 - a32 * a23;\n  const c4 = a21 * a33 - a31 * a23;\n  const c3 = a21 * a32 - a31 * a22;\n  const c2 = a20 * a33 - a30 * a23;\n  const c1 = a20 * a32 - a30 * a22;\n  const c0 = a20 * a31 - a30 * a21;\n\n  const det = s0 * c5 - s1 * c4 + s2 * c3 + s3 * c2 - s4 * c1 + s5 * c0;\n  if (!det)\n    return out;\n  const invdet = 1.0 / det;\n\n  out[0] = ( a11 * c5 - a12 * c4 + a13 * c3) * invdet;\n  out[1] = (-a01 * c5 + a02 * c4 - a03 * c3) * invdet;\n  out[2] = ( a31 * s5 - a32 * s4 + a33 * s3) * invdet;\n  out[3] = (-a21 * s5 + a22 * s4 - a23 * s3) * invdet;\n\n  out[4] = (-a10 * c5 + a12 * c2 - a13 * c1) * invdet;\n  out[5] = ( a00 * c5 - a02 * c2 + a03 * c1) * invdet;\n  out[6] = (-a30 * s5 + a32 * s2 - a33 * s1) * invdet;\n  out[7] = ( a20 * s5 - a22 * s2 + a23 * s1) * invdet;\n\n  out[8] = ( a10 * c4 - a11 * c2 + a13 * c0) * invdet;\n  out[9] = (-a00 * c4 + a01 * c2 - a03 * c0) * invdet;\n  out[10] = ( a30 * s4 - a31 * s2 + a33 * s0) * invdet;\n  out[11] = (-a20 * s4 + a21 * s2 - a23 * s0) * invdet;\n\n  out[12] = (-a10 * c3 + a11 * c1 - a12 * c0) * invdet;\n  out[13] = ( a00 * c3 - a01 * c1 + a02 * c0) * invdet;\n  out[14] = (-a30 * s3 + a31 * s1 - a32 * s0) * invdet;\n  out[15] = ( a20 * s3 - a21 * s1 + a22 * s0) * invdet;\n\n  return out;\n};\n\n/**\n * @param {number} alpha\n * @param {number} beta\n * @param {number} gamma\n * @return {!Float32Array}\n */\nMat4Util.CalculateRotationMat = function(alpha, beta, gamma) {\n  const x = beta;\n  const y = gamma;\n  const z = alpha;\n\n  const sx = Math.sin(x);\n  const cx = Math.cos(x);\n  const sy = Math.sin(y);\n  const cy = Math.cos(y);\n  const sz = Math.sin(z);\n  const cz = Math.cos(z);\n\n  return new Float32Array([\n      cz * cy - sz * sx * sy, cy * sz + cz * sx * sy, -cx * sy, 0,\n      -cx * sz, cz * cx, sx, 0,  \n      cy * sz * sx + cz * sy, sz * sy - cz * cy * sx, cx * cy, 0, \n      0, 0, 0, 1\n    ]);\n};\n\n/**\n * @param {!Float32Array} mat\n * @return {!Float32Array}\n */\nMat4Util.ClearTranslate = function(mat) {\n  mat[12] = 0.0;\n  mat[13] = 0.0;\n  mat[14] = 0.0;\n  return mat;\n};","/**\n * @constructor\n * @param {!HTMLImageElement} img\n * @param {!PanoInfo} info\n * @param {HTMLImageElement} exImg\n */\nconst PanoImage = function(img, info, exImg) {\n  /** @private {!HTMLImageElement} */\n  this._img = img;\n  /** @private {!PanoInfo} */\n  this._info = info;\n  /** @private {HTMLImageElement} */\n  this._exImg = exImg;\n};\n\nPanoImage.prototype = {\n  /** @return {!HTMLImageElement} */\n  GetImage: function() {\n    return this._img;\n  },\n  /** @return {!PanoInfo} */\n  GetInfo: function() {\n    return this._info;\n  },\n  /** @return {HTMLImageElement} */\n  GetExtImage: function() {\n    return this._exImg;\n  },\n};\n\n/**\n * @param {string} url\n * @return {Promise<!PanoImage>}\n */\nPanoImage.Load = function(url) {\n  return fetch(url)\n    .then((res) => res.blob())\n    .then((blob) => PanoImage.LoadBlob(blob));\n};\n\n/**\n * @param {string} url\n * @return {Promise<!HTMLImageElement>}\n * @private\n */\nPanoImage._loadImage = function(url) {\n  return new Promise((resolve, reject) => {\n    const image = new Image();\n    image.onload = (e) => resolve(image);\n    image.onerror = reject;\n    image.src = url;\n  });\n}\n\n/**\n * @param {!Blob} blob\n * @return {Promise<!ArrayBuffer>}\n * @private\n */\nPanoImage._readAsArrayBuffer = function(blob) {\n  return new Promise((resolve, reject) => {\n    const reader = new FileReader();\n    reader.onload = (e) => resolve(reader.result);\n    reader.onerror = reject;\n    reader.readAsArrayBuffer(blob);\n  });\n}\n\n/**\n * @param {Array<!Array<!Array<string>>>} metadata\n * @return {?string}\n * @private\n */\nPanoImage._getImageDataURLInMetedata = function(metadata) {\n  if (!metadata || !metadata[1])\n    return null;\n  const found = metadata[1].find((i) => i[0] == 'GImage:Data');\n  if (!found) \n    return null;\n  return 'data:image/jpeg;base64,' + found[1];\n}\n\n/**\n * @param {!Blob} blob\n * @return {Promise<!PanoImage>}\n */\nPanoImage.LoadBlob = function(blob) {\n  return Promise.all([PanoImage._loadImage(window.URL.createObjectURL(blob)),\n                      PanoImage._readAsArrayBuffer(blob)])\n    .then((results) => {\n      /** @type {!HTMLImageElement} */\n      const img = results[0];\n      /** @type {!ArrayBuffer} */\n      const arrayBuffer = results[1];\n      /** @type {Array<!Array<!Array<string>>>} */\n      const metadata = PanoImage._getXmpMetadata(arrayBuffer);\n      /** @type {!PanoInfo} */\n      const info = new PanoInfo(img, metadata);\n      /** @type {?string} */\n      const imageDataURL = PanoImage._getImageDataURLInMetedata(metadata);\n      if (!imageDataURL) {\n        return new PanoImage(img, info, null);\n      }\n      return PanoImage._loadImage(imageDataURL).then(exImg => {\n          return new PanoImage(img, info, exImg);\n        });\n    });\n};\n\n/**\n * @param {!ArrayBuffer} arrayBuffer\n * @return {Array<!Array<!Array<string>>>}\n * @private\n */\nPanoImage._getXmpMetadata = function(arrayBuffer) {\n  /** @type {Array<!Array<string>>} */\n  let standardSection = null;\n  /** @type {number} */\n  let pos = 0;\n  /** @type {?string} */\n  let extensionID = null;\n  /** @type {Uint8Array} */\n  let extensionData = null;\n  try {\n    if (read2Bytes() != 0xFFD8)\n      return null;\n    while (pos + 4 < arrayBuffer.byteLength) {\n      /** @const {number} */\n      const marker = read2Bytes();\n      /** @const {number} */\n      const size = read2Bytes();\n      if (marker == 0xFFDA)\n        break;\n      if (marker == 0xFFE1) {\n        if (isXmp()) {\n          const dom = getXmpDom(new Uint8Array(arrayBuffer, pos + 29, size - 31));\n          if (!dom)\n            return null;\n          standardSection = getLeafs(dom);\n          extensionID = hasExtendedXMPValue(standardSection);\n          if (!extensionID)\n            return [standardSection];\n          if (extensionID.length != 32)\n            return null;\n        } else if (isXmpExtension()) {\n          const tmpBytes = new Uint8Array(arrayBuffer, pos + 35 + 32, 8);\n          const fullSizeBytes = ((tmpBytes[0] * 0x100 + tmpBytes[1]) * 0x100 + tmpBytes[2]) * 0x100 + tmpBytes[3];\n          const offset = ((tmpBytes[4] * 0x100 + tmpBytes[5]) * 0x100 + tmpBytes[6]) * 0x100 + tmpBytes[7];\n          const chunkSize = size - 77;\n          if (extensionData === null) {\n            extensionData = new Uint8Array(fullSizeBytes);\n          }\n          extensionData.set(new Uint8Array(arrayBuffer, pos + 35 + 32 + 8, chunkSize), offset);\n        }\n      }\n      pos += size - 2;\n    }\n    if (extensionData) {\n      const dom = getXmpDom(extensionData);\n      if (!dom)\n        return [standardSection];\n      const extendedSection = getLeafs(dom);\n      return [standardSection, extendedSection];\n    }\n  } catch (e) {\n    console.error(e.toString());\n  }\n  return null;\n  /**\n   * @return {number}\n   */\n  function read2Bytes() {\n    const bytes =  new Uint8Array(arrayBuffer, pos, 2);\n    pos += 2;\n    return bytes[0] * 0x100 + bytes[1];\n  }\n  /**\n   * @return {boolean}\n   */\n  function isXmp() {\n    const bytes = new Uint8Array(arrayBuffer, pos, 29);\n    const t = String.fromCharCode.apply(null, bytes);\n    return t == 'http://ns.adobe.com/xap/1.0/\\0';\n  }\n  /**\n   * @return {boolean}\n   */\n  function isXmpExtension() {\n    const bytes = new Uint8Array(arrayBuffer, pos, 35 + 32);\n    const t = String.fromCharCode.apply(null, bytes);\n    return t == 'http://ns.adobe.com/xmp/extension/\\0' + extensionID;\n  }\n  /**\n   * @param {!Uint8Array} bytes\n   * @return {Document}\n   */\n  function getXmpDom(bytes) {\n    let xmpStr = new TextDecoder('utf-8').decode(bytes);\n    const startPos = xmpStr.search('<x:xmpmeta ');\n    const endPos = xmpStr.search('</x:xmpmeta>');\n    if (startPos == -1 || endPos == -1)\n      return null;\n    xmpStr = xmpStr.substr(startPos, endPos - startPos + 12);\n    const dom = (new DOMParser()).parseFromString(xmpStr, 'text/xml');\n    return dom;\n  }\n  /**\n   * @param {!Node} node\n   * @return {!Array<!Array<string>>}\n   */\n  function getLeafs(node) {\n    /** @type {!Array<Array<string>>} */\n    let list = [];\n    if (node.nodeType == 1) {\n      const attributes = node.attributes;\n      for (let i = 0; i < node.attributes.length; ++i) {\n        list.push([attributes[i].name, attributes[i].value]);\n      }\n    }\n    if (node.childNodes.length == 1 &&\n        node.childNodes[0].nodeType == 3) {\n      return [[node.nodeName, node.childNodes[0].nodeValue]];\n    }\n    for (let i = 0; i < node.childNodes.length; ++i)\n      list = list.concat(getLeafs(node.childNodes[i]));\n    return list;\n  }\n  /**\n   * @param {!Array<!Array<string>>} list\n   * @return {?string}\n   */\n  function hasExtendedXMPValue(list) {\n    const found = list.find((i) => i[0] == 'xmpNote:HasExtendedXMP');\n    if (!found)\n      return null;\n    return found[1];\n  }\n}","/**\n * @constructor\n * @param {!HTMLImageElement} img\n * @param {Array<!Array<!Array<string>>>} metadata\n */\nconst PanoInfo = function(img, metadata) {\n  /** @type {?number} */\n  let croppedAreaImageWidthPixels = null;\n  /** @type {?number} */\n  let croppedAreaImageHeightPixels = null;\n  /** @type {?number} */\n  let fullPanoWidthPixels = null;\n  /** @type {?number} */\n  let fullPanoHeightPixels = null;\n  /** @type {number} */\n  let croppedAreaLeftPixels = 0;\n  /** @type {number} */\n  let croppedAreaTopPixels = 0;\n  /** @type {number} */\n  let poseHeadingDegrees = 0;\n  /** @type {number} */\n  let posePitchDegrees = 0;\n  /** @type {number} */\n  let poseRollDegrees = 0;\n  /** @type {?number} */\n  let initialViewHeadingDegrees = null;\n  if (metadata && metadata[0]) {\n    for (let data of metadata[0]) {\n      if (data[0] == 'GPano:CroppedAreaImageWidthPixels') {\n        croppedAreaImageWidthPixels = Number(data[1]);\n      } else if (data[0] == 'GPano:CroppedAreaImageHeightPixels') {\n        croppedAreaImageHeightPixels = Number(data[1]);\n      } else if (data[0] == 'GPano:FullPanoWidthPixels') {\n        fullPanoWidthPixels = Number(data[1]);\n      } else if (data[0] == 'GPano:FullPanoHeightPixels') {\n        fullPanoHeightPixels = Number(data[1]);\n      } else if (data[0] == 'GPano:CroppedAreaLeftPixels') {\n        croppedAreaLeftPixels = Number(data[1]);\n      } else if (data[0] == 'GPano:CroppedAreaTopPixels') {\n        croppedAreaTopPixels = Number(data[1]);\n      } else if (data[0] == 'GPano:PoseHeadingDegrees') {\n        poseHeadingDegrees = Number(data[1]);\n      } else if (data[0] == 'GPano:PosePitchDegrees') {\n        posePitchDegrees = Number(data[1]);\n      } else if (data[0] == 'GPano:PoseRollDegrees') {\n        poseRollDegrees = Number(data[1]);\n      } else if (data[0] == 'GPano:InitialViewHeadingDegrees') {\n        initialViewHeadingDegrees = Number(data[1]);\n      }\n    }\n  }\n  if (croppedAreaImageWidthPixels === null) {\n    croppedAreaImageWidthPixels = img.width;\n  }\n  if (croppedAreaImageHeightPixels === null) {\n    croppedAreaImageHeightPixels = img.height;\n  }\n  if (fullPanoWidthPixels === null) {\n    fullPanoWidthPixels = img.width;\n  }\n  if (fullPanoHeightPixels === null) {\n    fullPanoHeightPixels = img.height;\n  }\n  if (initialViewHeadingDegrees === null) {\n    initialViewHeadingDegrees = (croppedAreaLeftPixels + croppedAreaImageWidthPixels * 0.5) / fullPanoWidthPixels * 360;\n  }\n  /** @private {!Float32Array} */\n  this._cropBase = new Float32Array([croppedAreaLeftPixels / fullPanoWidthPixels, croppedAreaTopPixels / fullPanoHeightPixels]);\n  /** @private {!Float32Array} */\n  this._cropSize = new Float32Array([croppedAreaImageWidthPixels / fullPanoWidthPixels, croppedAreaImageHeightPixels / fullPanoHeightPixels]);\n\n  const centerRot = (croppedAreaLeftPixels + croppedAreaImageWidthPixels * 0.5) / fullPanoWidthPixels * 2.0 * Math.PI;\n\n  const pitchMat =  Mat4Util.Pitch(posePitchDegrees * Mat4Util.DEG_TO_RAD);\n  const headingMat =  Mat4Util.Yaw(initialViewHeadingDegrees * Mat4Util.DEG_TO_RAD - centerRot);\n  const rollMat =  Mat4Util.Roll(-poseRollDegrees * Mat4Util.DEG_TO_RAD);\n  const invRotMat = Mat4Util.Inv(Mat4Util.Mul(headingMat, Mat4Util.Mul(pitchMat, rollMat)));\n\n  const centerHeadingMat =  Mat4Util.Yaw(-centerRot);\n  /** @private {!Float32Array} */\n  this._rotationMat = Mat4Util.Mul(centerHeadingMat, invRotMat);\n}\n\nPanoInfo.prototype = {\n  /** @return {!Float32Array} */\n  GetCropBase: function() {\n    return this._cropBase;\n  },\n  /** @return {!Float32Array} */\n  GetCropSize: function() {\n    return this._cropSize;\n  },\n  /** @return {!Float32Array} */\n  GetRotationMat: function() {\n    return this._rotationMat;\n  },\n};","\n/** \n * @const {string}\n * @private\n */\nconst VR_ICON_BASE64 =\n  'PHN2ZyB4bWxucz0iaHR0cDovL3d3dy53My5vcmcvMjAwMC9zdmciIHdpZHRoPSIyNCIgaGVp' +\n  'Z2h0PSIyNCI+PGcgZmlsbD0ibm9uZSIgZmlsbC1ydWxlPSJldmVub2RkIj48cGF0aCBmaWxs' +\n  'PSIjMDAwIiBkPSJNMjAuNjQgNkgzLjJDMi41NSA2IDIgNi41NyAyIDcuMjdWMTcuN2MwIC43' +\n  'LjU1IDEuMjcgMS4yMiAxLjI3SDhjLjUgMCAuOTUtLjMyIDEuMTMtLjc4bDEuMzktMy40N2Mu' +\n  'MjMtLjU5Ljc4LTEgMS40My0xIC42NSAwIDEuMi40MSAxLjQ0IDFsMS4zOSAzLjQ3Yy4xOC40' +\n  'Ni42Mi43OCAxLjEuNzhoNC43N2MuNyAwIDEuMjUtLjU3IDEuMjUtMS4yN1Y3LjI3YzAtLjct' +\n  'LjU1LTEuMjctMS4yNS0xLjI3em0tMTMuMiA4Ljc3YTIuMjQgMi4yNCAwIDAgMS0yLjIxLTIu' +\n  'MjhjMC0xLjI2Ljk4LTIuMjggMi4yLTIuMjggMS4yMiAwIDIuMiAxLjAyIDIuMiAyLjI4IDAg' +\n  'MS4yNi0uOTggMi4yOC0yLjIgMi4yOHptOS4wMiAwYTIuMjQgMi4yNCAwIDAgMS0yLjItMi4y' +\n  'OGMwLTEuMjYuOTgtMi4yOCAyLjItMi4yOCAxLjIxIDAgMi4yIDEuMDIgMi4yIDIuMjggMCAx' +\n  'LjI2LS45OSAyLjI4LTIuMiAyLjI4eiIvPjwvZz48L3N2Zz4=';\n/**\n * @const {string}\n * @private\n */\nconst OPEN_ICON_BASE64 =\n  'PHN2ZyB4bWxucz0iaHR0cDovL3d3dy53My5vcmcvMjAwMC9zdmciIHdpZHRoPSIyNCIgaGVp' +\n  'Z2h0PSIyNCIgdmlld0JveD0iMCAwIDI0IDI0Ij4KICAgIDxwYXRoIGQ9Ik0yMSAxOVY1YzAt' +\n  'MS4xLS45LTItMi0ySDVjLTEuMSAwLTIgLjktMiAydjE0YzAgMS4xLjkgMiAyIDJoMTRjMS4x' +\n  'IDAgMi0uOSAyLTJ6TTguNSAxMy41bDIuNSAzLjAxTDE0LjUgMTJsNC41IDZINWwzLjUtNC41' +\n  'eiIvPgogICAgPHBhdGggZD0iTTAgMGgyNHYyNEgweiIgZmlsbD0ibm9uZSIvPgo8L3N2Zz4K';\n\n/** @constructor */\nfunction PanoViewGLInfo() {\n  /** @type {WebGLUniformLocation} */\n  this.dispBase = null;\n  /** @type {WebGLUniformLocation} */\n  this.dispSize = null;\n  /** @type {WebGLUniformLocation} */\n  this.transMat = null;\n  /** @type {WebGLUniformLocation} */\n  this.cropBase = null;\n  /** @type {WebGLUniformLocation} */\n  this.cropSize = null;\n  /** @type {WebGLUniformLocation} */\n  this.texture = null;\n}\n\n/**\n * @param {!HTMLImageElement} img\n * @return {!HTMLImageElement|!HTMLCanvasElement}\n */\nfunction getPowOfTwoImage(img) {\n  /**\n   * @param {number} value\n   * @return {boolean}\n   */\n  function isPowOfTwo(value) {\n    return (value & (value - 1)) === 0 && value !== 0;\n  }\n  /**\n   * @param {number} value\n   * @param {number} max\n   * @return {number}\n   */\n  function nearestPowOfTwo(value, max) {\n    const pot = Math.pow(2, Math.round(Math.log( value ) / Math.LN2));\n    if (pot > max)\n      return max;\n    return pot;\n  }\n  if (isPowOfTwo(img.width) && isPowOfTwo(img.height)) {\n    return img;\n  }\n  \n  const canvas =\n      /** @type {!HTMLCanvasElement} */ (document.createElement('canvas'));\n  // TODO: Make the max size (2048) configurable.\n  canvas.width = nearestPowOfTwo(img.width, 2048);\n  canvas.height = nearestPowOfTwo(img.height, 2048);\n  canvas.getContext('2d').drawImage(img, 0, 0, canvas.width, canvas.height);\n  return canvas;\n}\n\n/**\n * @return {Promise<VRDisplay>}\n * @private\n */\nfunction getVRDisplay() {\n  if (!navigator.getVRDisplays) {\n    return Promise.resolve(null);\n  }\n  return navigator.getVRDisplays().then(\n    (displays) => {\n      if (!displays.length)\n        return null;\n      return displays[0];\n    },\n    (err) => {\n      console.error(err);\n      return null;\n    }\n  );\n}\n\n/**\n * @return {Promise<XRDevice>}\n * @private\n */\nfunction getXRDevice() {\n  if (!navigator.xr) {\n    return Promise.resolve(null);\n  }\n  return navigator.xr.requestDevice().then(\n    (device) => {\n      if (!device)\n        return null;  \n      return device.supportsSession({immersive: true}).then(\n        () => {\n          return device;\n        },\n        (err) => {\n          console.error(err);\n          return null;\n        });\n    },\n    (err) => {\n      console.error(err);\n      return null;\n    }\n  );\n}\n\n\n/**\n * @constructor\n * @param {!VRPanoViewOptions} options\n */\nconst PanoView = function(options) {\n\n  /** @type {Blob} */\n  this._blob = null;\n  /** @type {PanoInfo} */\n  this._panoImgInfo = null;\n  /** @type {HTMLImageElement|HTMLCanvasElement} */\n  this._leftImg = null;\n  /** @type {HTMLImageElement|HTMLCanvasElement} */\n  this._rightImg = null;\n\n  /** @type {XRDevice} */\n  this._xrDevice = null;\n  /** @type {VRDisplay} */\n  this._vrDisplay = null;\n\n  /** @type {number} */\n  this._screenOrientation = window.orientation || 0;\n  /** @type {Float32Array} */\n  this._deviceOrientationMat = null;\n\n  /** @type {number} */\n  this._rotateLong = 0;\n  /** @type {number} */\n  this._rotateLat = 0;\n\n  /** @type {WebGLRenderingContext} */\n  this._gl = null;\n  /** @type {PanoViewGLInfo} */\n  this._glLocs = null;\n  /** @type {WebGLTexture} */\n  this._canvasTexture = null\n  /** @type {WebGLTexture} */\n  this._canvasExtTexture = null\n  \n  /** @type {WebGLRenderingContext} */\n  this._xrGl = null;\n  /** @type {PanoViewGLInfo} */\n  this._xrGlLocs = null;\n  /** @type {WebGLTexture} */\n  this._xrTexture = null;\n  /** @type {WebGLTexture} */\n  this._xrExtTexture = null;\n  /** @type {XRSession} */\n  this._xrSession = null;\n  /** @type {XRFrameOfReference} */\n  this._xrFrameOfRef = null;\n\n  /** @type {boolean} */\n  this._stopCanvasRendering = false;\n\n  /** @type {!Promise<void>} */\n  this._initialized = new Promise((resolve) => {\n    /** @type {function(): void} */\n    this._resolveInitialization = resolve;\n  });\n\n  /** @type {Element} */\n  const container = document.getElementById(options.container);\n  if (!container) {\n    throw new Error('Container not found: ' + options.container);\n  }\n  /** @type {!Element} */\n  this._container = container\n  while (this._container.firstChild) {\n    this._container.removeChild(this._container.firstChild);\n  }\n\n  /** @type {!Element} */\n  this._root = document.createElement('div');\n  this._root.style.backgroundColor = 'black';\n  this._root.style.position = 'relative';\n  this._root.style.top = '0';\n  this._root.style.left = '0';\n  this._root.style.width = '100%';\n  this._root.style.height = '100%';\n  \n  /** @type {!HTMLCanvasElement} */\n  this._canvas =\n      /** @type {!HTMLCanvasElement} */ (document.createElement('canvas'));\n  this._resizeCanvas(this._container.clientWidth, this._container.clientHeight);\n\n  this._root.appendChild(this._canvas);\n  this._container.appendChild(this._root);\n\n  /** @type {boolean} */\n  this._option_open_btn = !!options.open_btn;\n\n  getXRDevice().then((device) => {\n    if (device) {\n      this._initializeWithXRDevice(device);\n      return;\n    }\n    getVRDisplay().then((vrDisplay) => {\n      if (vrDisplay && vrDisplay.capabilities.canPresent) {\n        this._initializeWithVRDevice(vrDisplay);\n      } else {\n        this._initialize();\n      }\n    });\n  })\n};\n\nPanoView.prototype = {\n  /**\n   * @param {!XRDevice} xrDevice\n   * @private\n   */\n  _initializeWithXRDevice: function(xrDevice) {\n    this._xrDevice = xrDevice;\n    this._addVRButton();\n    this._initialize();\n  },\n  /**\n   * @param {VRDisplay} vrDisplay\n   * @private\n   */\n  _initializeWithVRDevice: function(vrDisplay) {\n    this._vrDisplay = vrDisplay;\n    this._addVRButton();\n    this._initialize();\n  },\n  /**\n   * @private\n   */\n  _initialize: function() {\n    if (this._option_open_btn)\n      this._addOpenButton();\n\n    window.addEventListener('resize', this._onWindowResize.bind(this), false);\n    window.addEventListener('vrdisplaypresentchange', this._onVRPresentChange.bind(this), false);\n    window.addEventListener('vrdisplayactivate', this._onVRActivate.bind(this), false);\n    window.addEventListener('vrdisplaydeactivate', this._onVRDeactivate.bind(this), false);\n    \n    window.addEventListener('orientationchange', this._onOrientationChange.bind(this), false );\n    window.addEventListener('deviceorientation', this._onDeviceOrientation.bind(this), false );\n\n    this._canvas.addEventListener('mousedown', this._onMouseDown.bind(this), false);\n    this._canvas.addEventListener('mousemove', this._onMouseMove.bind(this), false);\n    window.addEventListener('mouseup', this._onMouseUp.bind(this),this);\n\n    this._canvas.addEventListener('touchstart', this._onTouchStart.bind(this), false);\n    this._canvas.addEventListener('touchmove', this._onTouchMove.bind(this), false);\n    window.addEventListener('touchend', this._onTouchEnd.bind(this),this);\n    \n    this._gl = this._getCanvasContext();\n    this._glLocs = this._initializeGL(this._gl);\n    this._canvas.addEventListener('webglcontextlost', this._onContextLost.bind(this), false);\n    this._canvas.addEventListener('webglcontextrestored', this._onContextRestored.bind(this), false);\n    window.requestAnimationFrame(this._render.bind(this), this._canvas);\n    this._resolveInitialization();\n  },\n  /**\n   * @return {!WebGLRenderingContext}\n   * @private\n   */\n  _getCanvasContext: function() {\n    return /** @type {!WebGLRenderingContext} */ (\n        this._canvas.getContext('webgl'));\n  },\n  /**\n   * @private\n   */\n  _addVRButton: function() {\n    /** @type {!Element}} */\n    const vrButton = this._createButton(VR_ICON_BASE64);\n    vrButton.style.right = '5px';\n    this._root.appendChild(vrButton);\n    vrButton.addEventListener('click', () => this.StartVR());\n  },\n  /**\n   * @private\n   */\n  _addOpenButton: function() {\n    /** @type {!Element}} */\n    const openButton = this._createButton(OPEN_ICON_BASE64);\n    openButton.style.left = '5px';\n    this._root.appendChild(openButton);\n    openButton.addEventListener('click', () => this.OpenFile());\n  },\n  /**\n   * @param {string} iconBase64\n   * @return {!Element}\n   * @private\n   */\n  _createButton: function(iconBase64) {\n    const button = document.createElement('div');\n    button.style.backgroundColor = 'white';\n    button.style.position = 'absolute';\n    button.style.width = '36px';\n    button.style.height = '36px';\n    button.style.bottom = '5px';\n    button.style.borderRadius = '36px';\n    button.style.cursor = 'pointer';\n    button.style.opacity = '0.5';\n\n    const icon = document.createElement('div');\n    icon.style.position = 'absolute';\n    icon.style.backgroundColor = 'blue';\n    icon.style.top = '2px';\n    icon.style.left = '2px';\n    icon.style.width = '32px';\n    icon.style.height = '32px';\n    icon.style.background =\n        'url(\"data:image/svg+xml;base64,' + iconBase64 +\n        '\") left top/100% no-repeat';\n    button.appendChild(icon);\n    return button;\n  },\n  /**\n   * @private\n   */\n  _onWindowResize: function() {\n    if (this._stopCanvasRendering)\n      return;\n    if (this._vrDisplay && this._vrDisplay.isPresenting)\n      return;\n    if (this._canvas.width == this._container.clientWidth &&\n        this._canvas.height == this._container.clientHeight) {\n      return;\n    }\n    this._resizeCanvas(this._container.clientWidth, this._container.clientHeight);\n  },\n  /**\n   * @private\n   */\n  _onOrientationChange: function() {\n    this._screenOrientation = window.orientation || 0;\n  },\n  /**\n   * @param {!Event} event\n   * @private\n   */\n  _onDeviceOrientation: function(event) {\n    this._deviceOrientationMat = Mat4Util.CalculateRotationMat(\n      event.alpha * Mat4Util.DEG_TO_RAD,\n      event.beta * Mat4Util.DEG_TO_RAD,\n      event.gamma * Mat4Util.DEG_TO_RAD);\n  },\n  /**\n   * @param {!Event} event\n   * @private\n   */\n  _onMouseDown: function(event) {\n    this._startRotate(event);\n  },\n  /**\n   * @param {!Event} event\n   * @private\n   */\n  _onMouseMove: function(event) {\n    if (event.buttons !== 0) {\n      event.preventDefault();\n      this._rotate(event);\n    }\n  },\n  /**\n   * @param {!Event} event\n   * @private\n   */\n  _onMouseUp: function(event) {\n    this._endRotate();\n  },\n  /**\n   * @param {!Event} event\n   * @private\n   */\n  _onTouchStart: function(event) {\n    if (event.touches.length == 1) {\n      this._startRotate(event.touches[0]);\n    }\n  },\n  /**\n   * @param {!Event} event\n   * @private\n   */\n  _onTouchMove: function(event) {\n    if (event.touches.length == 1) {\n      event.preventDefault();\n      this._rotate(event.touches[0]);\n    }\n  },\n  /**\n   * @param {!Event} event\n   * @private\n   */\n  _onTouchEnd: function(event) {\n    this._endRotate();\n  },\n  /**\n   * @param {!Event} event\n   * @private\n   */\n  _startRotate: function(event) {\n    this._rotating = true;\n    this._mouseX = event.clientX;\n    this._mouseY = event.clientY;\n  },\n  /**\n   * @param {!Event} event\n   * @private\n   */\n  _rotate: function(event) {\n    if (!this._rotating)\n      return;\n    const diffX = event.clientX - this._mouseX;\n    const diffY = event.clientY - this._mouseY;\n    this._rotateLong += diffX * Math.PI / this._canvas.width;\n    this._rotateLat += diffY * Math.PI / this._canvas.height;\n    if (this._rotateLat < - Math.PI / 2)\n      this._rotateLat = - Math.PI / 2;\n    if (this._rotateLat > Math.PI / 2)\n      this._rotateLat = Math.PI / 2;\n    this._mouseX = event.clientX;\n    this._mouseY = event.clientY;\n  },\n  /**\n   * @private\n   */\n  _endRotate: function() {\n    this._rotating = false;\n  },\n  /**\n   * @param {number} width\n   * @param {number} height\n   * @private\n   */\n  _resizeCanvas: function(width, height) {\n    this._canvas.width = width;\n    this._canvas.height = height;\n  },\n  /**\n   * @param {!WebGLRenderingContext} gl\n   * @return {!PanoViewGLInfo}\n   */\n  _initializeGL: function(gl) {\n    /** @type {!WebGLBuffer} */\n    const buffer = gl.createBuffer();\n    gl.bindBuffer(gl.ARRAY_BUFFER, buffer);\n    gl.bufferData(\n        gl.ARRAY_BUFFER,\n        new Float32Array([-1.0, -1.0, 1.0, -1.0, -1.0, 1.0, -1.0, 1.0, 1.0, -1.0, 1.0,  1.0]),\n        gl.STATIC_DRAW);\n    /** @type {string} */\n    const vShaderTxt = [\n        'attribute vec2 pos;',\n        'void main() {',\n        '  gl_Position = vec4(pos, 0, 1);',\n        '}',\n      ].join('\\n');\n    /** @type {!WebGLShader} */\n    const vertexShader = gl.createShader(gl.VERTEX_SHADER);\n    gl.shaderSource(vertexShader, vShaderTxt);\n    gl.compileShader(vertexShader);\n\n    /** @type {string} */\n    const fShaderTxt = [\n        '#define PI 3.1415925358979',\n        '#define PI2 6.2831850718',\n        'precision highp float;',\n        'uniform sampler2D texture;',\n        'uniform vec2 dispBase;',\n        'uniform vec2 dispSize;',\n        'uniform mat4 transMat;',\n        'uniform vec2 cropBase;',\n        'uniform vec2 cropSize;',\n        '',\n        'void main() {',\n        '  vec4 pos = vec4((gl_FragCoord.x - dispBase.x)/(dispSize.x * 0.5) - 1.0 ,',\n        '                  (gl_FragCoord.y - dispBase.y)/(dispSize.y * 0.5) - 1.0 ,',\n        '                  0.0, 1.0);',\n        '  vec4 origPos = transMat * pos;',\n        '  float lon = atan(origPos.x, -origPos.z);',\n        '  float lat = atan(origPos.y, sqrt(origPos.x * origPos.x + origPos.z * origPos.z));',\n        '  if (lon < 0.0) {',\n        '    lon += PI2;',\n        '  }',\n        '  float texX = (lon / PI2 - cropBase.x) / cropSize.x;',\n        '  float texY = (0.5 - lat / PI -  cropBase.y) / cropSize.y; ',\n        '  if ((texX <= -0.0) || (1.0 <= texX) || (texY <= -0.0) || (1.0 <= texY)) {' ,\n        '    gl_FragColor = vec4(0.0, 0.0, 0.0, 1.0);' ,\n        '    return;' ,\n        '  }' ,\n        '  gl_FragColor = texture2D(texture, vec2(texX, texY));',\n        '}'\n      ].join('\\n');\n    /** @type {!WebGLShader} */\n    const fragmentShader = gl.createShader(gl.FRAGMENT_SHADER);\n    gl.shaderSource(fragmentShader, fShaderTxt);\n    gl.compileShader(fragmentShader);\n\n    /** @type {!WebGLProgram} */\n    const program = gl.createProgram();\n    gl.attachShader(program, vertexShader);\n    gl.attachShader(program, fragmentShader);\n    gl.linkProgram(program);\n    gl.useProgram(program);\n\n    /** @type {number} */\n    const positionLocation = gl.getAttribLocation(program, 'pos');\n    gl.enableVertexAttribArray(positionLocation);\n    gl.vertexAttribPointer(positionLocation, 2, gl.FLOAT, false, 0, 0);\n\n    /** @type {!PanoViewGLInfo} */\n    const glInfo = new PanoViewGLInfo();\n    glInfo.dispBase = gl.getUniformLocation(program, 'dispBase');\n    glInfo.dispSize = gl.getUniformLocation(program, 'dispSize');\n    glInfo.transMat = gl.getUniformLocation(program, 'transMat');\n    glInfo.cropBase = gl.getUniformLocation(program, 'cropBase');\n    glInfo.cropSize = gl.getUniformLocation(program, 'cropSize');\n    glInfo.texture = gl.getUniformLocation(program, 'texture');\n    return glInfo;\n  },\n  /**\n   * @param {!Event} event\n   * @private\n   */\n  _onContextLost: function(event) {\n    event.preventDefault();\n    this._gl = null;\n    this._canvasTexture = null;\n    this._canvasExtTexture = null;\n    this._leftImg = null;\n    this._rightImg = null;\n  },\n  /**\n   * @param {!Event} event\n   * @private\n   */\n  _onContextRestored: function(event) {\n    const gl = this._getCanvasContext();\n    this._glLocs = this._initializeGL(gl);\n\n    if (!this._blob) {\n      this._gl = gl;\n      return;\n    }\n    PanoImage.LoadBlob(this._blob)\n      .then((panoImg) => {\n        this._gl = gl;\n        this._panoImgInfo = panoImg.GetInfo();\n        this._leftImg = getPowOfTwoImage(panoImg.GetImage());\n        const extImg = panoImg.GetExtImage();\n        if (extImg) {\n          this._rightImg = getPowOfTwoImage(extImg);\n        }\n      });\n  },\n  /**\n   * @param {!number} t\n   * @private\n   */\n  _render: function(t) {\n    if (this._stopCanvasRendering)\n      return;\n    if (this._vrDisplay && this._vrDisplay.isPresenting) {\n      this._vrDisplay.requestAnimationFrame(this._render.bind(this));\n    } else {\n      window.requestAnimationFrame(this._render.bind(this), this._canvas);\n    }\n    if (!this._panoImgInfo || !this._gl || !this._leftImg)\n      return;\n\n    if (!this._canvasTexture) {\n      this._canvasTexture = this._createTexture(this._gl, this._leftImg);\n    }\n    if (this._rightImg && !this._canvasExtTexture) {\n      this._canvasExtTexture = this._createTexture(this._gl, this._rightImg);\n    }\n\n    this._gl.uniform2fv(this._glLocs.cropBase, this._panoImgInfo.GetCropBase());\n    this._gl.uniform2fv(this._glLocs.cropSize, this._panoImgInfo.GetCropSize());\n\n    if (this._vrDisplay && this._vrDisplay.isPresenting) {\n      /** @type {!VRFrameData} */\n      const frameData = new VRFrameData();\n      this._vrDisplay.getFrameData(frameData);\n\n      const leftInvPrjMat = Mat4Util.Inv(frameData.leftProjectionMatrix);\n      const leftInvViewMat = Mat4Util.ClearTranslate(Mat4Util.Inv(frameData.leftViewMatrix));\n      const leftTransMat =  Mat4Util.Mul(this._panoImgInfo.GetRotationMat(), Mat4Util.Mul(leftInvViewMat, leftInvPrjMat));\n      this._draw(this._gl, this._glLocs, 0, 0, this._canvas.width* 0.5, this._canvas.height, leftTransMat, this._canvasTexture);\n\n      const rightInvPrjMat = Mat4Util.Inv(frameData.rightProjectionMatrix);\n      const rightInvViewMat = Mat4Util.ClearTranslate(Mat4Util.Inv(frameData.rightViewMatrix));\n      const rightTransMat =  Mat4Util.Mul(this._panoImgInfo.GetRotationMat(), Mat4Util.Mul(rightInvViewMat, rightInvPrjMat));\n      this._draw(this._gl, this._glLocs, this._canvas.width* 0.5, 0, this._canvas.width* 0.5, this._canvas.height, rightTransMat, this._canvasExtTexture ? this._canvasExtTexture : this._canvasTexture);\n      this._vrDisplay.submitFrame();\n    } else {\n      const projectionMatrix = new Float32Array([1, 0, 0, 0,  0, 1, 0, 0,  0, 0, -1, 0,  0, 0, -1, 1]);\n      let invViewMat = new Float32Array([1, 0, 0, 0,  0, 1, 0, 0,  0, 0, 1, 0,  0, 0, 0, 1]);\n      const rate = this._canvas.width / this._canvas.height;\n      if (rate > 1) {\n        projectionMatrix[0] = 1 / rate;\n      } else {\n        projectionMatrix[5] = rate;\n      }\n      const invPrjMat = Mat4Util.Inv(projectionMatrix);\n      if (this._deviceOrientationMat) {\n        const screenRotMat = Mat4Util.Roll(-this._screenOrientation * Mat4Util.DEG_TO_RAD);\n        invViewMat  = Mat4Util.Mul(Mat4Util.Yaw(- Math.PI / 2),Mat4Util.Mul(Mat4Util.Pitch(-Math.PI / 2), Mat4Util.Mul(this._deviceOrientationMat, screenRotMat)));\n      }\n\n      if (!this._deviceOrientationMat) {\n        invViewMat = Mat4Util.Mul(Mat4Util.Pitch(this._rotateLat), invViewMat);\n      }\n      invViewMat = Mat4Util.Mul(Mat4Util.Yaw(this._rotateLong), invViewMat);\n      const transMat =  Mat4Util.Mul(this._panoImgInfo.GetRotationMat(), Mat4Util.Mul(invViewMat, invPrjMat));\n      this._draw(this._gl, this._glLocs, 0, 0, this._canvas.width, this._canvas.height, transMat, this._canvasTexture);\n    }\n  },\n  /**\n   * @param {!WebGLRenderingContext} gl\n   * @param {!PanoViewGLInfo} locs\n   * @param {number} viewportX\n   * @param {number} viewportY\n   * @param {number} viewportW\n   * @param {number} viewportH\n   * @param {!Float32Array} trasMat\n   * @param {!WebGLTexture} texture\n   * @private\n   */\n  _draw: function(gl, locs, viewportX, viewportY, viewportW, viewportH, trasMat, texture) {\n    gl.viewport(viewportX, viewportY, viewportW, viewportH);\n    gl.uniform2f(locs.dispBase,  viewportX, viewportY);\n    gl.uniform2f(locs.dispSize, viewportW, viewportH);\n    gl.uniformMatrix4fv(locs.transMat, false, trasMat);\n    gl.bindTexture(gl.TEXTURE_2D, texture);\n    gl.uniform1i(locs.texture, 0);\n    gl.drawArrays(gl.TRIANGLES, 0, 6);\n    gl.bindTexture(gl.TEXTURE_2D, null);\n  },\n  /**\n   * @param {!WebGLRenderingContext} gl\n   * @param {!HTMLImageElement|!HTMLCanvasElement} image\n   * @return {!WebGLTexture}\n   * @private\n   */\n  _createTexture: function(gl, image) {\n    const texture = gl.createTexture();\n    gl.bindTexture(gl.TEXTURE_2D, texture);\n    gl.texImage2D(gl.TEXTURE_2D, 0, gl.RGBA, gl.RGBA, gl.UNSIGNED_BYTE, image);\n    gl.generateMipmap(gl.TEXTURE_2D);\n    gl.texParameteri(gl.TEXTURE_2D, gl.TEXTURE_MIN_FILTER, gl.LINEAR);\n    gl.texParameteri(gl.TEXTURE_2D, gl.TEXTURE_MAG_FILTER, gl.LINEAR);\n    gl.texParameteri(gl.TEXTURE_2D, gl.TEXTURE_WRAP_S, gl.REPEAT);\n    gl.texParameteri(gl.TEXTURE_2D, gl.TEXTURE_WRAP_T, gl.REPEAT);\n    gl.bindTexture(gl.TEXTURE_2D, null);\n    return texture;\n  },\n  /**\n   * @private\n   */\n  OpenFile: function() {\n    if (this._fileInput) {\n      document.body.removeChild(this._fileInput);\n    }\n    this._fileInput = document.createElement('input');\n    this._fileInput.type = 'file';\n    this._fileInput.accept = 'image/jpeg';\n    this._fileInput.name = 'files[]';\n    this._fileInput.style.display = 'none';\n    document.body.appendChild(this._fileInput);\n    this._fileInput.addEventListener('change', (function () {\n      let tmpBlob = this._fileInput.files[0];\n      document.body.removeChild(this._fileInput);\n      this._fileInput = null;\n      PanoImage.LoadBlob(tmpBlob).then((panoImg) => {\n          this._blob = tmpBlob;\n          this._loadPanoImage(panoImg);\n        });\n      }).bind(this), false);\n    document.body.appendChild(this._fileInput);\n    this._fileInput.click();\n  },\n  /**\n   * @param {string} url\n   * @return {Promise<void>}\n   * @private\n   */\n  Load: function(url) {\n    /** @type {Blob} */\n    let tmpBlob = null;\n    return this._initialized \n      .then(() => fetch(url))\n      .then((res) => res.blob())\n      .then((blob) => {\n        tmpBlob = blob;\n        return PanoImage.LoadBlob(blob);\n      })\n      .then((panoImg) => {\n        this._blob = tmpBlob;\n        this._loadPanoImage(panoImg);\n      });\n  },\n  /**\n   * @param {!PanoImage} panoImg\n   * @private\n   */\n  _loadPanoImage: function(panoImg) {\n    if (this._canvasTexture) {\n      this._gl.deleteTexture(this._canvasTexture);\n    }\n    if (this._canvasExtTexture) {\n      this._gl.deleteTexture(this._canvasExtTexture);\n    }\n    if (this._xrTexture) {\n      this._xrGl.deleteTexture(this._xrTexture);\n    }\n    if (this._xrExtTexture) {\n      this._xrGl.deleteTexture(this._xrExtTexture);\n    }\n    this._canvasTexture = null;\n    this._canvasExtTexture = null;\n    this._xrTexture = null;\n    this._xrExtTexture = null;\n    this._leftImg = null;\n    this._rightImg = null;\n\n    this._panoImgInfo = panoImg.GetInfo();\n\n    this._leftImg = getPowOfTwoImage(panoImg.GetImage());\n    const extImg = panoImg.GetExtImage();\n    if (extImg) {\n      this._rightImg = getPowOfTwoImage(extImg);\n    }\n  },\n  /**\n   * @private\n   */\n  StartVR: function() {\n    this._initialized.then(() => {\n      this._stopCanvasRendering = true;\n      if (this._vrDisplay) {\n        /** @type {VREyeParameters} */\n        const leftEye = this._vrDisplay.getEyeParameters('left');\n        this._resizeCanvas(leftEye.renderWidth * 2, leftEye.renderHeight);\n        this._vrDisplay.requestPresent([{source: this._canvas}]).then(() => {\n          this._stopCanvasRendering = false;\n          this._vrDisplay.requestAnimationFrame(this._render.bind(this));\n        }, (err) => {\n          this._stopCanvasRendering = false;\n          console.error(err);\n        });\n        return;\n      }\n      this._xrDevice.requestSession({immersive: true}).then((session) => {\n        this._xrSession = session;\n        this._xrSession.addEventListener('end', this._onXRSessionEnded.bind(this));\n        const canvas = document.createElement('canvas');\n        this._xrGl = \n            /** @type {!WebGLRenderingContext} */ (\n              canvas.getContext('webgl', {\n                'compatibleXRDevice': session.device\n              }));\n        this._xrSession.baseLayer = new XRWebGLLayer(this._xrSession, this._xrGl);\n        this._xrGlLocs = this._initializeGL(this._xrGl);\n        if (this._leftImg) {\n          this._xrTexture = this._createTexture(this._xrGl, this._leftImg);\n        }\n        if (this._rightImg) {\n          this._xrExtTexture = this._createTexture(this._xrGl, this._rightImg);\n        }\n        this._xrSession.requestFrameOfReference('eye-level').then((frameOfRef) => {\n          this._xrFrameOfRef = frameOfRef;\n          this._xrSession.requestAnimationFrame(this._onXRFrame.bind(this));\n        });\n      });\n    });\n  },\n  /**\n   * @private\n   */\n  _onVRPresentChange: function() {\n    if (!this._vrDisplay.isPresenting) {\n      this._resizeCanvas(this._container.clientWidth, this._container.clientHeight);\n      window.requestAnimationFrame(this._render.bind(this), this._canvas);\n    }\n  },\n  /**\n   * @private\n   */\n  _onVRActivate: function() {\n    this.StartVR();\n  },\n  /**\n   * @private\n   */\n  _onVRDeactivate: function() {\n    this._vrDisplay.exitPresent().then(() => {\n    }, (err) => {\n      console.error(err);\n    });\n  },\n  /**\n   * @private\n   */\n  _onXRSessionEnded: function() {\n    console.log('_onXRSessionEnded');\n    this._stopCanvasRendering = false;\n    window.requestAnimationFrame(this._render.bind(this), this._canvas);\n  },\n  /**\n   * @param {number} t\n   * @param {XRFrame} frame\n   * @private\n   */\n  _onXRFrame: function(t, frame) {\n    if (!this._xrGl || !this._leftImg || !frame)\n      return;\n    this._xrSession.requestAnimationFrame(this._onXRFrame.bind(this));\n    const pose = frame.getDevicePose(this._xrFrameOfRef);\n    if (!pose)\n      return;\n\n    if (!this._xrTexture) {\n      this._xrTexture = this._createTexture(this._xrGl, this._leftImg);\n    }\n    if (this._rightImg && !this._xrExtTexture) {\n      this._xrExtTexture = this._createTexture(this._xrGl, this._rightImg);\n    }\n\n    this._xrGl.bindFramebuffer(this._xrGl.FRAMEBUFFER, this._xrSession.baseLayer.framebuffer);\n    this._xrGl.clear(this._xrGl.COLOR_BUFFER_BIT | this._xrGl.DEPTH_BUFFER_BIT);\n    \n    this._xrGl.uniform2fv(this._xrGlLocs.cropBase, this._panoImgInfo.GetCropBase());\n    this._xrGl.uniform2fv(this._xrGlLocs.cropSize, this._panoImgInfo.GetCropSize());\n\n    for (let view of frame.views) {\n      let viewport = this._xrSession.baseLayer.getViewport(view);\n      this._xrGl.viewport(viewport.x, viewport.y, viewport.width, viewport.height);\n      let invPrjMat = Mat4Util.Inv(view.projectionMatrix);\n      let invViewMat = Mat4Util.ClearTranslate(Mat4Util.Inv(pose.getViewMatrix(view)));\n      const transMat =  Mat4Util.Mul(this._panoImgInfo.GetRotationMat(), Mat4Util.Mul(invViewMat, invPrjMat));\n      let texture = this._xrTexture;\n      if (view.eye == 'right' && this._xrExtTexture) {\n        texture = this._xrExtTexture;\n      }\n      this._draw(this._xrGl, this._xrGlLocs, viewport.x, viewport.y, viewport.width, viewport.height, transMat, texture);\n    }\n  }\n};\n\n\nwindow['VRPanoView'] = PanoView;\nwindow['VRPanoView'].prototype['Load'] = PanoView.prototype.Load;\n"],
"names":["$jscomp.defineProperty","$jscomp.global","$jscomp.initSymbol","$jscomp.Symbol","$jscomp.SYMBOL_PREFIX","$jscomp.arrayIterator","$jscomp.initSymbolIterator","$jscomp.iteratorPrototype","Mat4Util.DEG_TO_RAD","Math","PI","Mat4Util.Yaw","yaw","s","sin","c","cos","Float32Array","Mat4Util.Pitch","pitch","Mat4Util.Roll","roll","Mat4Util.Mul","a","b","out","a00","a10","a20","a30","a01","a11","a21","a31","a02","a12","a22","a32","a03","a13","a23","a33","b00","b10","b20","b30","b01","b11","b21","b31","b02","b12","b22","b32","b03","b13","b23","b33","Mat4Util.Inv","s0","s1","s2","s3","s4","s5","c5","c4","c3","c2","c1","c0","det","invdet","Mat4Util.ClearTranslate","mat","PanoImage","img","info","exImg","_img","_info","_exImg","prototype","PanoImage._loadImage","url","Promise","resolve","reject","image","Image","onload","image.onload","onerror","src","PanoImage._readAsArrayBuffer","blob","reader","FileReader","reader.onload","result","readAsArrayBuffer","PanoImage._getImageDataURLInMetedata","metadata","found","find","i","PanoImage.LoadBlob","all","window","URL","createObjectURL","then","results","PanoImage._getXmpMetadata","arrayBuffer","PanoInfo","imageDataURL","read2Bytes","bytes","Uint8Array","pos","isXmp","String","fromCharCode","apply","t","isXmpExtension","extensionID","getXmpDom","xmpStr","decode","TextDecoder","startPos","search","endPos","substr","parseFromString","DOMParser","dom","getLeafs","node","list","nodeType","attributes","length","push","name","value","childNodes","nodeName","nodeValue","concat","hasExtendedXMPValue","standardSection","extensionData","byteLength","marker","size","tmpBytes","fullSizeBytes","offset","chunkSize","set","extendedSection","e","console","error","toString","croppedAreaImageWidthPixels","croppedAreaImageHeightPixels","fullPanoWidthPixels","fullPanoHeightPixels","croppedAreaLeftPixels","croppedAreaTopPixels","posePitchDegrees","poseRollDegrees","initialViewHeadingDegrees","$jscomp.makeIterator","data","Number","width","height","_cropBase","_cropSize","centerRot","invRotMat","headingMat","pitchMat","rollMat","_rotationMat","centerHeadingMat","PanoViewGLInfo","texture","cropSize","cropBase","transMat","dispSize","dispBase","getPowOfTwoImage","isPowOfTwo","nearestPowOfTwo","max","pot","pow","round","log","LN2","canvas","document","createElement","getContext","drawImage","getVRDisplay","navigator","getVRDisplays","displays","err","getXRDevice","xr","requestDevice","device","supportsSession","immersive","PanoView","options","_vrDisplay","_xrDevice","_rightImg","_leftImg","_panoImgInfo","_blob","_screenOrientation","orientation","_deviceOrientationMat","_rotateLat","_rotateLong","_xrFrameOfRef","_xrSession","_xrExtTexture","_xrTexture","_xrGlLocs","_xrGl","_canvasExtTexture","_canvasTexture","_glLocs","_gl","_stopCanvasRendering","_initialized","_resolveInitialization","container","getElementById","Error","_container","firstChild","removeChild","_root","style","backgroundColor","position","top","left","_canvas","_resizeCanvas","clientWidth","clientHeight","appendChild","_option_open_btn","open_btn","_initializeWithXRDevice","_addVRButton","_initialize","vrDisplay","capabilities","canPresent","_initializeWithVRDevice","_onWindowResize","isPresenting","_onOrientationChange","_onDeviceOrientation","event","alpha","beta","gamma","sx","cx","sy","cy","sz","cz","_onMouseDown","_startRotate","_rotating","_mouseX","clientX","_mouseY","clientY","_onMouseMove","buttons","preventDefault","_rotate","_onMouseUp","_endRotate","_onTouchStart","touches","_onTouchMove","_onTouchEnd","_onContextLost","_onContextRestored","gl","_getCanvasContext","_initializeGL","panoImg","extImg","_render","requestAnimationFrame","bind","_createTexture","uniform2fv","frameData","VRFrameData","getFrameData","leftInvPrjMat","leftProjectionMatrix","leftInvViewMat","leftViewMatrix","leftTransMat","_draw","rightInvPrjMat","rightProjectionMatrix","rightInvViewMat","rightViewMatrix","rightTransMat","submitFrame","projectionMatrix","invViewMat","rate","invPrjMat","screenRotMat","Load","tmpBlob","fetch","res","_loadPanoImage","_onVRPresentChange","_onVRActivate","StartVR","_onVRDeactivate","exitPresent","_onXRSessionEnded","_onXRFrame","frame","pose","getDevicePose","bindFramebuffer","FRAMEBUFFER","baseLayer","framebuffer","clear","COLOR_BUFFER_BIT","DEPTH_BUFFER_BIT","views","view","viewport","getViewport","x","y","getViewMatrix","eye","leftEye","getEyeParameters","renderWidth","renderHeight","requestPresent","source","requestSession","session","addEventListener","XRWebGLLayer","requestFrameOfReference","frameOfRef","deleteTexture","OpenFile","_fileInput","body","type","accept","display","files","click","createTexture","bindTexture","TEXTURE_2D","texImage2D","RGBA","UNSIGNED_BYTE","generateMipmap","texParameteri","TEXTURE_MIN_FILTER","LINEAR","TEXTURE_MAG_FILTER","TEXTURE_WRAP_S","REPEAT","TEXTURE_WRAP_T","locs","viewportX","viewportY","viewportW","viewportH","trasMat","uniform2f","uniformMatrix4fv","uniform1i","drawArrays","TRIANGLES","buffer","createBuffer","bindBuffer","ARRAY_BUFFER","bufferData","STATIC_DRAW","vertexShader","createShader","VERTEX_SHADER","shaderSource","vShaderTxt","compileShader","fragmentShader","FRAGMENT_SHADER","fShaderTxt","program","createProgram","attachShader","linkProgram","useProgram","positionLocation","getAttribLocation","enableVertexAttribArray","vertexAttribPointer","FLOAT","glInfo","getUniformLocation","diffY","_createButton","iconBase64","button","bottom","borderRadius","cursor","opacity","icon","background","_addOpenButton","openButton","OPEN_ICON_BASE64","vrButton","VR_ICON_BASE64","right"]
}
